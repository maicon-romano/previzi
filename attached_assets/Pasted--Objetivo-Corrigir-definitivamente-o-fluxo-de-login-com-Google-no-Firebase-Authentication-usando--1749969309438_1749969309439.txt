**Objetivo: Corrigir definitivamente o fluxo de login com Google no Firebase Authentication (usando Redirect) e ajustar as configurações de Cross-Origin-Opener-Policy no Firebase Hosting.**

---

### ✅ Contexto atual do projeto:

* Frontend: React + Vite
* Roteamento: Já migrado de `wouter` para `react-router-dom`
* Backend: Firebase Hosting
* Autenticação: Firebase Auth (client-side)
* Projeto no GitHub: [https://github.com/maicon-romano/previzi](https://github.com/maicon-romano/previzi)

---

### ✅ Problema exato:

Hoje o login com Google **abre o Redirect corretamente**, volta para o app, mas **o `getRedirectResult()` não recupera o usuário** e **o sistema continua na tela de login**, sem logar.

Além disso, estava tendo erros de **Cross-Origin-Opener-Policy** antes (quando era popup), então migrei para Redirect, mas ainda sem sucesso.

---

### ✅ O que preciso que você faça:

---

#### 1. Corrigir definitivamente o fluxo de login com Redirect:

✅ **Usar apenas:**

* `signInWithRedirect()`
* `getRedirectResult()`
* `onAuthStateChanged()`

✅ Garanta que:

* Ao clicar no botão de "Login com Google", o redirect aconteça.
* Ao retornar, o `getRedirectResult()` pegue o usuário com sucesso.
* O usuário seja salvo no `AuthContext` com `setCurrentUser()`.
* O app redirecione automaticamente para `/dashboard` após o login com sucesso.

---

#### 2. Ajustar a política de CORS/COOP no Firebase Hosting:

✅ Se for necessário, ajuste o `firebase.json` para garantir que os headers do Firebase Hosting **não quebrem o fluxo de redirect** (deixe o mínimo de restrições possível para o Auth funcionar).

---

#### 3. Garantir build e deploy:

✅ Depois de tudo, execute:

```bash
npm run build
firebase deploy
```

✅ Teste o fluxo completo no **ambiente de produção do Firebase Hosting**, no link:
[https://previzi-54773.web.app](https://previzi-54773.web.app)

---

#### 4. Extra:

✅ Se quiser, pode mover minha `firebaseConfig` para dentro de um `firebaseConfig.ts` para melhor organização, mas **sem usar .env ou Secrets do Replit**.

---

### ✅ Resumo Final:

**A meta é:**

✅ Login com Google via Redirect funcionando
✅ Sem erros de CORS/COOP
✅ Usuário logado com sucesso após o redirect
✅ Redirecionamento pós-login funcionando (`/dashboard`)
✅ Build e deploy ok no Firebase Hosting

